

import streamlit as st
import pandas as pd

# é¤å…æ•°æ®
restaurants = pd.DataFrame({
    "é¤å…åç§°": ["èˆ’è®°è€å‹ç²‰", "å¤©ç¦é¦™è€å‹ç²‰", "ä¸‰å“ç‹ç‰›è‚‰ç²‰", "å§œèƒ–èƒ–è‡ªåŠ©çƒ¤è‚‰", "ç‰›æ‰’å¤§äº¨è¥¿é¤å…","ç´ å®´Â·è”¬é£Ÿ(ç´ é£Ÿè‡ªåŠ©é¤å…ç§‘å¾·åº—)","éš†æ±ŸçŒªè„šé¥­(è¡¡é˜³åº—)","å°å›å®¶çŒªè„šé¥­Â·çƒ§å¤Â·ç™½åˆ‡(å‹çˆ±åº—)","ä¹è§‚é¢å±‹(ä¸œç›Ÿåº—)","é‡åº†æ±Ÿæ¹–æ‹Œé¢","è‹æ°å°é¾™è™¾(ä¸œé¸£è·¯åº—)","ä¸‰å…„å¼Ÿå°é¾™è™¾é¦†","è‹æ ¼é‡Œå²›è‡ªåŠ©æµ·é²œçƒ¤è‚‰","å‰å¸ƒé²ç‰›æ’æµ·é²œè‡ªåŠ©(å—å®æ±Ÿå—ä¸‡è¾¾åº—)","é¹¿å®¢è‡»é²œÂ·æµ·é²œçƒ¤è‚‰è‡ªåŠ©é¤å…(è“é²¸ä¸–ç•Œåº—)","ä»Šé‚•çƒ§çƒ¤(å›­æ¹–åº—)","èˆŒæˆ˜çƒ§çƒ¤é…’é¦†(ä¸‰è¡—ä¸¤å··åº—)","äº¿å£é¦™é¾™è™¾","ç‚™çˆ±çƒ§çƒ¤(ä¸‡ç§€åº—)","å¤æœ—è›‹ç³•(åŸå¸‚èŠ±å›­åº—)","å¡å¡ç±³è‹Â·ç”Ÿæ—¥è›‹ç³•(è¥¿ä¹¡å¡˜åº—)","å²æ‚¦ç”œèœœè›‹ç³•åº—","ç››è®°é¡ºå¾·é«˜ä½¬çŒªæ‚ç²¥åº—","å—å®å¸‚é›²èŒç‘¶é…’æ¥¼","å•«å•«æ‘-ç”Ÿæ–™å•«å•«ç…²(åŸŒè¥¿åº—)"],
    "ç±»å‹": ["ä¸­é¤", "ä¸­é¤", "å¿«é¤", "è‡ªåŠ©é¤", "è¥¿é¤","è‡ªåŠ©","å ‚é£Ÿ","å ‚é£Ÿ","ç²‰","ç²‰","å°åƒ","å°åƒ","è‡ªåŠ©","è‡ªåŠ©","è‡ªåŠ©","çƒ§çƒ¤","çƒ§çƒ¤","å°åƒ","çƒ§çƒ¤","ç³•ç‚¹","ç³•ç‚¹","ç³•ç‚¹","ç²¥","è‡ªåŠ©","å ‚é£Ÿ"],
    "è¯„åˆ†": [4.4, 4.1, 4.5, 4.9, 4.3,4.6,4.7,4.4,4.5,4.2,4.7,4.6,4.6,4.5,4.3,4.8,4.6,4.3,4.2,4.6,4.7,4.4,4.5,4.2,4.7],
    "äººå‡æ¶ˆè´¹(å…ƒ)": [15, 15, 20, 60, 80,30,30,39,21,20,98,103,78,80,90,123,90,120,89,68,55,134,15,200,34],
    "è¥ä¸šæ—¶é—´": ["6:00-22:00","9:00-22:00","5:00-23:00","10:00-23:00","12:00-24:00","17:00-20:30","10:30-20:00","9:00-19:00","9:00-20:00","9:00-20:00","9:30-20:00","12:00-23:00","12:00-23:00","12:300-23:00","12:00-23:00","17:00-23:00","17:00-02:00","17:00-02:00","12:300-23:00","12:300-23:00","17:30-22:00","7:30-22:00","7:30-22:00","7:30-22:00","7:30-22:00"],
    "latitude": [22.809728,22.822481,22.838432,22.789523,22.808867,22.848224,22.831269,22.839999,22.689112,22.810435,23.160266,22.756756,22.813919,22.790188,22.769671,22.826847,22.813768,22.845349,22.789165,22.808243,22.846720,22.688017,22.819031,22.798990,22.805077],
    "longitude": [108.324614,108.387910,108.262110,108.313493,108.326838,108.257296,108.310691,108.309224,108.267817,108.403375,108.284216,108.332567,108.321484,108.312827,108.306724,108.339396,108.320656,108.315969,108.318908,108.370764,108.300288,109.460925,108.343062,108.378891,108.368414]
})






st.markdown('### é—¨åº—è¯¦ç»†æ•°æ®ï¼ˆä»…å±•ç¤ºè¯„åˆ†å¤§äº4.5çš„åº—é“ºï¼‰')

#ä»…å±•ç¤ºè¯„åˆ†å¤§äº4.5çš„åº—
high_rating = restaurants[restaurants["è¯„åˆ†"] >= 4.5]
# æ˜¾ç¤ºè¡¨æ ¼ï¼ˆå¯æ’åºã€æœç´¢ï¼‰
st.dataframe(high_rating[["é¤å…åç§°", "ç±»å‹", "è¯„åˆ†", "äººå‡æ¶ˆè´¹(å…ƒ)","è¥ä¸šæ—¶é—´"]])




st.markdown("### äººå‡æ¶ˆè´¹æ•°æ®")

st.bar_chart(restaurants.set_index("é¤å…åç§°")["äººå‡æ¶ˆè´¹(å…ƒ)"])


st.markdown('### é—¨åº—è¯„åˆ†æ•°æ®ï¼ˆä»…å±•ç¤ºè¯„åˆ†å¤§äº4.5çš„åº—é“ºï¼‰')






# è®¾ç½®é¤å…åç§°ä¸ºç´¢å¼•ï¼ˆXè½´ï¼‰
data_for_chart = restaurants.set_index("é¤å…åç§°")["è¯„åˆ†"]

# ç»˜åˆ¶é¢ç§¯å›¾
st.area_chart(data_for_chart)


st.markdown('### ä»·æ ¼èµ°åŠ¿æŠ˜çº¿å›¾')

data = {
    'æœˆä»½': ['ä¸€æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 
           'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'åä¸€æœˆ', 'åäºŒæœˆ'],
    'ä¹¦è®°è€å‹ç²‰': [15, 18, 14, 17, 19, 31, 22, 13, 17, 13, 11, 21],
    'å¤©ç¦é¦™è€å‹ç²‰': [18, 16, 21, 24, 45, 21, 12, 24, 26, 16, 18, 25],
    'ä¸‰å“ç‹ç‰›è‚‰ç²‰': [23, 21, 34, 23, 25, 35, 53, 27, 21, 24, 32, 14],
     'å§œèƒ–èƒ–è‡ªåŠ©çƒ¤è‚‰': [115, 145, 95, 122, 165, 116, 131, 151, 125, 99, 123, 156],
    'ä¹è§‚é¢å±‹(ä¸œç›Ÿåº—)': [27, 25, 34, 35, 21, 41, 12, 35, 23, 34, 28, 45]
}

df=pd.DataFrame(data)
df=pd.DataFrame(data)
index=pd.Series([1,2,3,4,5,6,7,8,9,10,11,12],name='åºå·')
df.index=index
st.line_chart(df, x='æœˆä»½')




import pydeck as pdk

# æ–¹æ³•1ï¼šä¿®å¤ st.map() çš„æ‚¬åœ
st.header("åŸºç¡€åœ°å›¾ï¼ˆè‡ªåŠ¨æ‚¬åœï¼‰")
st.map(restaurants[["latitude", "longitude", "é¤å…åç§°"]])  # åªä¼ éœ€è¦çš„åˆ—



import streamlit.components.v1 as components



# é…ç½®
TENCENT_API_KEY = "7QTBZ-NDMLM-GAQ6N-6YN54-XVWL2-5WFQS"
restaurants = pd.DataFrame({
    "name": ["èˆ’è®°è€å‹ç²‰", "å¤©ç¦é¦™è€å‹ç²‰", "ä¸‰å“ç‹ç‰›è‚‰ç²‰"],
    "lat": [22.809728, 22.822481, 22.838432],
    "lng": [108.324614, 108.387910, 108.262110],
    "price": [15, 15, 20]
})

# ç”Ÿæˆåœ°å›¾
map_html = f"""
<!DOCTYPE html>
<html>
<head>
    <script src="https://map.qq.com/api/gljs?v=1.exp&key={TENCENT_API_KEY}"></script>
    <style>#map {{ width:100%; height:500px; }}</style>
</head>
<body>
    <div id="map"></div>
    <script>
        var map = new TMap.Map("map", {{
            center: new TMap.LatLng(22.82, 108.35),
            zoom: 12,
            mapStyleId: "å«æ˜Ÿå›¾"
        }});

        // åŠ¨æ€åŠ è½½Pythonæ•°æ®
        var restaurants = {restaurants.to_json(orient="records")};
        
        restaurants.forEach(restaurant => {{
            var marker = new TMap.Marker({{
                position: new TMap.LatLng(restaurant.lat, restaurant.lng),
                map: map,
                content: '<div style="background:#FF6D00;color:white;padding:4px 8px;">' + restaurant.name + '</div>'
            }});

            marker.on("click", () => {{
                new TMap.InfoWindow({{
                    map: map,
                    position: new TMap.LatLng(restaurant.lat, restaurant.lng),
                    content: `
                        <h3>${{restaurant.name}}</h3>
                        <p>äººå‡: ï¿¥${{restaurant.price}}å…ƒ</p>
                    `
                }}).open();
            }});
        }});
    </script>
</body>
</html>
"""

# æ˜¾ç¤º
st.title("ğŸœ å—å®é¤å…åœ°å›¾ï¼ˆè…¾è®¯å«æ˜Ÿå›¾ï¼‰")
components.html(map_html, height=550)
